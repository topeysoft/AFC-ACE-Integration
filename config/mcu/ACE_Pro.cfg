# AFC-ACE Configuration Template
# ACE Pro Multi-Material Unit Configuration
#
# This file provides a template for configuring ACE Pro devices with AFC.
# Each ACE Pro device provides 4 lanes (filament slots).

# ==============================================================================
# SINGLE ACE PRO CONFIGURATION (4 lanes)
# ==============================================================================

[AFC_ACE ace1]
# Serial port - Use auto-detected /dev/serial/by-path for stability
serial: /dev/serial/by-path/platform-xhci-hcd.0-usb-0:1.3:1.0

# OR use auto-detection (recommended)
# auto_detect: true
# device_index: 0  # 0 = first ACE, 1 = second ACE, etc.

# Baud rate (default 115200)
baud: 115200

# Hub configuration (optional - AFC can work without hub)
# hub: hub

# Extruder configuration
extruder: extruder

# Buffer configuration (optional)
# buffer: buffer

# LED configuration (optional - set LED colors for this unit)
# led_fault: 1,0,0,0              # Red
# led_ready: 0,1,0,0              # Green
# led_not_ready: 1,1,0,0          # Yellow
# led_loading: 1,0,0,0            # Red
# led_tool_loaded: 0,0,1,0        # Blue

# Movement speeds (optional - defaults from AFC.cfg)
# long_moves_speed: 150
# long_moves_accel: 250
# short_moves_speed: 50
# short_moves_accel: 300

# ==============================================================================
# LANES - One per ACE slot (4 total)
# ==============================================================================

# Lane 1 (ACE Slot 0)
[AFC_lane leg1]
unit: ace1:0              # ace1 = unit name, 0 = slot index
map: T0                   # Toolchange command (T0 selects this lane)
extruder: extruder        # Extruder this lane feeds

# Optional: Prep and load sensors (configure pins for your hardware)
# prep: <MCU_pin>         # Sensor at lane entrance (e.g., ^PA0)
# load: <MCU_pin>         # Sensor at lane exit (e.g., ^PA1)

# Optional: LED configuration for this lane
# led_index: 0            # Index in LED chain
# led_spool_index: 0      # LED under spool (illumination)

# Optional: Distance from lane to hub (if using hub)
# dist_hub: 60

# Lane 2 (ACE Slot 1)
[AFC_lane leg2]
unit: ace1:1
map: T1
extruder: extruder

# Lane 3 (ACE Slot 2)
[AFC_lane leg3]
unit: ace1:2
map: T2
extruder: extruder

# Lane 4 (ACE Slot 3)
[AFC_lane leg4]
unit: ace1:3
map: T3
extruder: extruder

# ==============================================================================
# MULTI-ACE CONFIGURATION (8+ lanes)
# ==============================================================================
# To add a second ACE (lanes 4-7):

# [AFC_ACE ace2]
# auto_detect: true
# device_index: 1         # Second ACE device
# extruder: extruder
#
# [AFC_lane leg5]
# unit: ace2:0
# map: T4
# extruder: extruder
#
# [AFC_lane leg6]
# unit: ace2:1
# map: T5
# extruder: extruder
#
# [AFC_lane leg7]
# unit: ace2:2
# map: T6
# extruder: extruder
#
# [AFC_lane leg8]
# unit: ace2:3
# map: T7
# extruder: extruder

# ==============================================================================
# NOTES
# ==============================================================================
#
# 1. ACE Pro Device Mapping:
#    - Each ACE Pro has 4 slots (0-3)
#    - Each slot becomes an AFC lane
#    - Lanes use unit:slot_index format
#
# 2. Serial Port Selection:
#    - Recommended: Use auto_detect for plug-and-play
#    - Alternative: Use /dev/serial/by-path for stability
#    - Not recommended: /dev/ttyACM* (changes on reboot)
#
# 3. Multi-ACE Setup:
#    - ACE devices are numbered by USB port order
#    - device_index: 0 = first detected, 1 = second, etc.
#    - Lane numbering continues across ACEs (T0-T3, T4-T7, etc.)
#
# 4. Lane Sensors:
#    - ACE Pro manages filament loading internally
#    - External sensors are optional for AFC integration
#    - Useful for detecting filament runout at extruder
#
# 5. Feed Assist:
#    - ACE Pro has built-in feed assist
#    - Automatically enabled during tool changes
#    - Can be controlled via AFC commands
#
# 6. AFC Features:
#    - All standard AFC features work with ACE
#    - Endless spool, tip forming, purging, etc.
#    - ACE dryer can be controlled via macros
